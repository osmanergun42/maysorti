<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>

<button onclick="downloadPDF()">PDF İndir</button>

<script>
  function downloadPDF() {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF({ orientation: 'landscape' }); // Sayfa yatay

    doc.text("Üretim Takip Tablosu", 14, 10);

    const table = document.getElementById("group-table");
    const data = [];
    const headers = [];

    // Tablo başlıklarını al
    table.querySelectorAll("thead tr th").forEach(th => {
      headers.push(th.innerText);
    });

    data.push(headers); // Başlıkları ekle

    // Tablo verilerini al
    table.querySelectorAll("tbody tr").forEach(tr => {
      const row = [];
      tr.querySelectorAll("td").forEach(td => {
        const input = td.querySelector("input, select");
        row.push(input ? input.value : td.innerText);
      });
      data.push(row);
    });

    doc.autoTable({
      head: [headers],
      body: data.slice(1), // İlk satır başlık olduğu için veri kısmını alıyoruz
      startY: 20,
      styles: { fontSize: 8 }, // Yazı fontu küçültüldü
      columnStyles: {
        0: { cellWidth: 10 },   // # sütunu küçük tut
        1: { cellWidth: 20 },   // Giriş
        2: { cellWidth: 20 },   // Çıkış
        3: { cellWidth: 30 },   // Ürün
        4: { cellWidth: 20 },   // Kg
        5: { cellWidth: 20 },   // Giriş
        6: { cellWidth: 20 },   // Çıkış
        7: { cellWidth: 30 },   // Ürün
        8: { cellWidth: 20 },   // Kg
        9: { cellWidth: 20 },   // Giriş
        10: { cellWidth: 20 },  // Çıkış
        11: { cellWidth: 30 },  // Ürün
        12: { cellWidth: 20 },  // Kg
        13: { cellWidth: 20 },  // Giriş
        14: { cellWidth: 20 },  // Çıkış
        15: { cellWidth: 30 },  // Ürün
        16: { cellWidth: 20 },  // Kg
      },
      margin: { top: 15 },
    });

    doc.save("Uretim_Takip_Tablosu.pdf");
  }
</script>
